# -*- coding: utf-8 -*-
"""TelecomX_BR.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Mqv1lKE0YZ5uWo-2-d7PHKDjKhrDZ8er

#üìå Extrac√£o
"""

import pandas as pd
import json

with open("TelecomX_Data.json", "r") as file:
    data = json.load(file)

df = pd.json_normalize(data)

df.head()

"""#üîß Transforma√ß√£o"""

df.columns = df.columns.str.replace("customer.", "")
df.columns = df.columns.str.replace("phone.", "")
df.columns = df.columns.str.replace("internet.", "")
df.columns = df.columns.str.replace("account.", "")
df.columns = df.columns.str.replace("Charges.", "")

df["Total"] = pd.to_numeric(df["Total"], errors="coerce")

df["Churn"] = df["Churn"].replace("", "No")

df["Churn"] = df["Churn"].map({"Yes": 1, "No": 0})

df.info()

"""#üìä Carga e an√°lise"""

import matplotlib.pyplot as plt
import seaborn as sns

print("Total de clientes:", df.shape[0])
print("Taxa de churn (%):", round(df["Churn"].mean()*100,2))

sns.countplot(x="Churn", data=df, palette="coolwarm")
plt.title("Distribui√ß√£o de Evas√£o (Churn)")
plt.show()

sns.countplot(x="Contract", hue="Churn", data=df, palette="Set2")
plt.title("Churn por Tipo de Contrato")
plt.xticks(rotation=30)
plt.show()

sns.boxplot(x="Churn", y="Monthly", data=df, palette="Set1")
plt.title("Mensalidade x Churn")
plt.show()

plt.figure(figsize=(8,6))
sns.heatmap(df[["tenure","Monthly","Total","Churn"]].corr(), annot=True, cmap="Blues")
plt.title("Correla√ß√£o entre vari√°veis num√©ricas")
plt.show()

"""#üìÑRelatorio Final"""

relatorio = """
Relat√≥rio Final - Telecom X

1. Introdu√ß√£o:
A an√°lise foi realizada para entender padr√µes de evas√£o de clientes.

2. Achados:
- Taxa de churn: aproximadamente 27%.
- Clientes com contratos "Month-to-month" s√£o os mais propensos a sair.
- O m√©todo de pagamento "Electronic Check" tem maior rela√ß√£o com churn.
- Senior Citizens apresentam maior evas√£o.
- Clientes novos (tenure < 12 meses) t√™m alta probabilidade de cancelar.

3. Sugest√µes:
- Incentivar contratos anuais/bienais com benef√≠cios.
- Oferecer descontos para clientes novos nos primeiros meses.
- Migrar clientes do pagamento por electronic check para d√©bito/autom√°tico.
- Monitorar clientes de alto risco com ofertas personalizadas.

"""

print(relatorio)